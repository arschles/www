---
author: "Aaron Schlesinger"
date: 2020-05-18T15:55:19-07:00
title: '2020 05 18 Dapr 3'

# For twitter cards, see https://github.com/mtn/cocoa-eh-hugo-theme/wiki/Twitter-cards
# meta_img = "/images/image.jpg"

# For hacker news and lobsters builtin links, see github.com/mtn/cocoa-eh-hugo-theme/wiki/Social-Links
# hacker_news_id = ""
# lobsters_id = ""
---

Dapr! No, not [dapper](https://dev.to/1kevgriff/what-is-dapper-and-why-you-should-consider-it-for-your-net-projects-cm4), [dapr](https://dapr.io).

If you haven't read my past [articles](https://dev.to/arschles/what-is-dapr-526a) about dapr, that's ok. Let me try to boil this big project down to a sentence:

>üëã Dapr is a process you run that does all the hard stuff for your app you'd rather not do

And with that, let's talk about (and demo!) probably the hardest thing that most (any?) apps have to deal with: storing data. 

>üôã‚Äç‚ôÄÔ∏è Dapr does [other things](https://github.com/dapr/docs/tree/master/concepts#building-blocks) besides storage too

# The Hard Thing About ~~Hard Things~~ Data Storage

Dealing with data stores are hard. You have to get the right SDK, mock out your data store for unit tests, write integration tests for round-tripping data, make sure you deal with migrations, failover, and more...

Dapr helps with this, but it also comes with some limitations too. Before we go demo the thing, some pros and cons for storage:

- ‚ûï You read/write data with a pretty simple REST API (or gRPC!)
- ‚ûï You get a lot of useful features (retries anyone?)
- ‚ûï You can swap out implementations (Dapr comes with a bunch of [different implementations](https://github.com/dapr/docs/tree/master/concepts/state-management#state-management-api) of the data API across clouds and open/closed source.)
- ‚ûñ You have to fit your data model into key/value. Not all apps fit into this model
- ‚ûï and ‚ûñ You have to do a bit of reading and wrangling to take advantage of some useful storage features:
    - Strong consistency
    - Optimistic Concurrency
    - Retry policies

>‚Ñπ In Dapr land, the data storage API isn't called a database on purpose because it gives you a key/value storage API. It's not SQL or any other kind of rich query language, so keep that in mind when deciding what to use.

If you want, you can check out more details on storage [here](https://github.com/dapr/docs/tree/master/concepts/state-management#state-management-api).


# üèÑ‚Äç‚ôÄÔ∏è Surf's Up, Let's Demo This Thing

Dapr comes with a bunch of [different implementations](https://github.com/dapr/docs/tree/master/concepts/state-management#state-management-api) of the data API across clouds and open/closed source. We'll use the Redis implementation here.

## 1Ô∏è‚É£ - Installing

I followed the [installing](https://github.com/dapr/docs/blob/master/getting-started/environment-setup.md#using-script-to-install-the-latest-release) instructions, using the Linux script (since I'm [using WSL2](https://dev.to/arschles/how-to-wsl-516d)):

```shell
$ wget -q https://raw.githubusercontent.com/dapr/cli/master/install/install.sh -O - | /bin/bash
```

>I had to provide my password because the script `sudo`s things, so if you're not into letting a random script from GitHub get superuser on your computer, you can [download binaries](https://github.com/dapr/docs/blob/master/getting-started/environment-setup.md#from-the-binary-releases) instead.

It was installed and I could test things out:

```shell
DESKTOP-DQP07VM :: ~ ¬ª dapr --help

         __
    ____/ /___ _____  _____
   / __  / __ '/ __ \/ ___/
  / /_/ / /_/ / /_/ / /
  \__,_/\__,_/ .___/_/
              /_/

======================================================
A serverless runtime for hyperscale, distributed systems

Usage:
  dapr [command]

Available Commands:
  components     List all Dapr components
  configurations List all Dapr configurations
  help           Help about any command
  init           Setup dapr in Kubernetes or Standalone modes
  invoke         Invokes a Dapr app with an optional payload (deprecated, use invokePost)
  invokeGet      Issue HTTP GET to Dapr app
  invokePost     Issue HTTP POST to Dapr app with an optional payload
  list           List all Dapr instances
  logs           Gets Dapr sidecar logs for an app in Kubernetes
  mtls           Check if mTLS is enabled in a Kubernetes cluster
  publish        Publish an event to multiple consumers
  run            Launches Dapr and (optionally) your app side by side
  status         Shows the Dapr system services (control plane) health status.
  stop           Stops a running Dapr instance and its associated app
  uninstall      Removes a Dapr installation

Flags:
  -h, --help      help for dapr
      --version   version for dapr

Use "dapr [command] --help" for more information about a command.
```

It even has ascii art ü§°!

## 2Ô∏è‚É£ Hello, World!

Ok, stuff's installed, so let's see this in action.

